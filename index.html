<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CuratedStack - Curated Apps Directory</title>
  <link rel="icon" href="logo.svg">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       DESIGN TOKENS â€” DARK (default)
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    :root {
      --accent:       #a78bfa;
      --accent-2:     #38bdf8;
      --accent-rgb:   167,139,250;

      --text:         rgba(255,255,255,0.92);
      --text-muted:   rgba(255,255,255,0.50);
      --text-faint:   rgba(255,255,255,0.28);

      --glass-bg:     rgba(255,255,255,0.06);
      --glass-bg-h:   rgba(255,255,255,0.11);
      --glass-modal:  rgba(15,12,41,0.82);
      --glass-border: rgba(255,255,255,0.11);
      --glass-bdr-h:  rgba(var(--accent-rgb),0.42);
      --blur:         16px;
      --blur-modal:   30px;

      --nav-bg:       rgba(10,8,30,0.65);
      --sh-card:      0 4px 24px rgba(0,0,0,0.32), 0 1px 0 rgba(255,255,255,0.06) inset;
      --sh-hover:     0 8px 40px rgba(0,0,0,0.50), 0 0 0 1px rgba(var(--accent-rgb),0.28);
      --sh-modal:     0 28px 90px rgba(0,0,0,0.65);

      --skel-from:    rgba(255,255,255,0.04);
      --skel-to:      rgba(255,255,255,0.10);

      --radius-sm:    8px;
      --radius-md:    14px;
      --radius-lg:    20px;
      --radius-xl:    28px;
      --font:         'Inter', system-ui, sans-serif;
      --trans:        0.22s cubic-bezier(.22,1,.36,1);
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       LIGHT MODE
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    [data-theme="light"] {
      --accent:       #7c3aed;
      --accent-2:     #0284c7;
      --accent-rgb:   124,58,237;
      --text:         rgba(15,10,40,0.92);
      --text-muted:   rgba(15,10,40,0.52);
      --text-faint:   rgba(15,10,40,0.30);
      --glass-bg:     rgba(255,255,255,0.55);
      --glass-bg-h:   rgba(255,255,255,0.75);
      --glass-modal:  rgba(248,246,255,0.90);
      --glass-border: rgba(100,80,200,0.13);
      --glass-bdr-h:  rgba(var(--accent-rgb),0.35);
      --nav-bg:       rgba(240,238,255,0.72);
      --sh-card:      0 4px 24px rgba(80,60,180,0.08), 0 1px 0 rgba(255,255,255,0.7) inset;
      --sh-hover:     0 8px 40px rgba(80,60,180,0.16), 0 0 0 1px rgba(var(--accent-rgb),0.20);
      --sh-modal:     0 28px 90px rgba(60,40,160,0.22);
      --skel-from:    rgba(0,0,0,0.04);
      --skel-to:      rgba(0,0,0,0.10);
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       RESET & BASE (glass themes)
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }

    body {
      font-family: var(--font);
      font-size: 15px;
      color: var(--text);
      min-height: 100vh;
      overflow-x: hidden;
      transition: color 0.3s, background 0.5s;
    }

    /* BG Canvas â€” sits behind everything */
    #bg-canvas {
      position: fixed;
      inset: 0;
      width: 100%; height: 100%;
      z-index: -1;
      pointer-events: none;
    }

    [data-theme="dark"] body,
    [data-theme="dark"] {
      background: #0f0c29;
    }

    [data-theme="light"] {
      background: #f0eeff;
    }

    body::before {
      content: '';
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 0;
      opacity: 0.35;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.04'/%3E%3C/svg%3E");
      transition: opacity 0.4s;
    }

    /* Parallax orbs */
    .orb {
      position: fixed;
      border-radius: 50%;
      pointer-events: none;
      z-index: 0;
      filter: blur(80px);
      will-change: transform;
      transition: opacity 0.4s;
    }
    .orb-1 {
      width: 500px; height: 500px;
      top: -100px; left: -100px;
      background: radial-gradient(circle, rgba(124,58,237,0.18) 0%, transparent 70%);
    }
    .orb-2 {
      width: 400px; height: 400px;
      bottom: -80px; right: -80px;
      background: radial-gradient(circle, rgba(56,189,248,0.14) 0%, transparent 70%);
    }
    [data-theme="light"] .orb-1 { background: radial-gradient(circle,rgba(124,58,237,0.09) 0%,transparent 70%); }
    [data-theme="light"] .orb-2 { background: radial-gradient(circle,rgba(56,189,248,0.07) 0%,transparent 70%); }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       WIN95 OVERRIDES (applied via JS class)
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    [data-theme="win95"] {
      background: teal !important;
    }
    [data-theme="win95"] body {
      background: teal !important;
      font-family: 'Pixelated MS Sans Serif', Arial, sans-serif !important;
    }
    [data-theme="win95"] body::before { opacity: 0 !important; }
    [data-theme="win95"] .orb { display: none !important; }

    [data-theme="win95"] .navbar {
      background: #c0c0c0 !important;
      backdrop-filter: none !important;
      border-bottom: 2px solid !important;
      border-color: #ffffff #808080 #808080 #ffffff !important;
      padding: 4px 8px !important;
    }
    [data-theme="win95"] .navbar-brand { color: #000 !important; font-family: Arial, sans-serif !important; }
    [data-theme="win95"] .brand-gradient {
      background: none !important;
      -webkit-text-fill-color: #000 !important;
      color: #000 !important;
      font-weight: bold !important;
    }
    [data-theme="win95"] .theme-toggle {
      background: #c0c0c0 !important;
      border: 2px solid !important;
      border-color: #ffffff #808080 #808080 #ffffff !important;
      color: #000 !important;
      border-radius: 0 !important;
      backdrop-filter: none !important;
    }
    [data-theme="win95"] .theme-toggle::before { display: none !important; }
    [data-theme="win95"] .navbar-stats { color: #000 !important; }
    [data-theme="win95"] .navbar-stats strong { color: #000 !important; }

    [data-theme="win95"] .hero { display: none !important; }

    [data-theme="win95"] .filter-bar {
      max-width: 100% !important;
      background: #c0c0c0;
      border: 2px solid;
      border-color: #ffffff #808080 #808080 #ffffff;
      padding: 6px 10px;
      margin-bottom: 16px !important;
      border-radius: 0 !important;
      gap: 8px;
    }
    [data-theme="win95"] .search-input {
      background: #fff !important;
      border: 2px inset #808080 !important;
      border-radius: 0 !important;
      color: #000 !important;
      font-family: Arial, sans-serif !important;
      font-size: 12px !important;
      backdrop-filter: none !important;
    }
    [data-theme="win95"] .filter-select {
      background: #fff !important;
      border: 2px inset #808080 !important;
      border-radius: 0 !important;
      color: #000 !important;
      font-family: Arial, sans-serif !important;
      font-size: 12px !important;
      backdrop-filter: none !important;
      background-image: none !important;
      padding-right: 14px !important;
    }

    [data-theme="win95"] .category-label { color: #fff !important; font-family: Arial, sans-serif !important; font-size: 12px !important; font-weight: bold !important; }
    [data-theme="win95"] .category-line { background: rgba(255,255,255,0.3) !important; }
    [data-theme="win95"] .category-count {
      background: #c0c0c0 !important;
      border: 2px solid !important;
      border-color: #ffffff #808080 #808080 #ffffff !important;
      color: #000 !important;
      border-radius: 0 !important;
    }

    [data-theme="win95"] .site-footer {
      background: #c0c0c0;
      border-top: 2px solid #808080;
      color: #000 !important;
    }
    [data-theme="win95"] .site-footer a { color: #000080 !important; }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       NAVBAR
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .navbar {
      position: sticky;
      top: 0; z-index: 100;
      padding: 12px 24px;
      display: flex;
      align-items: center;
      gap: 16px;
      background: var(--nav-bg);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-bottom: 1px solid var(--glass-border);
      transition: background var(--trans), border-color 0.3s;
    }
    .navbar-brand {
      display: flex; align-items: center; gap: 8px;
      font-weight: 700; font-size: 17px; letter-spacing: -0.3px;
      color: var(--text); text-decoration: none;
    }
    .navbar-brand img { width: 28px; height: 28px; }
    .brand-gradient {
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .navbar-right { display: flex; align-items: center; gap: 12px; margin-left: auto; }
    .navbar-stats { display: flex; gap: 20px; font-size: 12px; color: var(--text-muted); }
    .navbar-stats strong { color: var(--text); font-weight: 600; }

    /* Theme toggle */
    .theme-toggle {
      width: 36px; height: 36px;
      border-radius: 50%;
      border: 1px solid var(--glass-border);
      background: var(--glass-bg);
      backdrop-filter: blur(12px);
      color: var(--text-muted);
      font-size: 16px;
      cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      transition: background var(--trans), border-color var(--trans),
                  color var(--trans), transform 0.3s ease;
      flex-shrink: 0;
      position: relative;
    }
    .theme-toggle:hover {
      background: var(--glass-bg-h);
      color: var(--text);
      border-color: rgba(var(--accent-rgb),0.4);
      transform: rotate(20deg) scale(1.08);
    }
    .theme-toggle:active { transform: rotate(0deg) scale(0.95); }

    /* Tooltip */
    .theme-toggle::before {
      content: attr(data-tip);
      position: absolute;
      bottom: calc(100% + 8px);
      right: 0;
      background: rgba(0,0,0,0.75);
      color: #fff;
      font-size: 11px;
      font-weight: 500;
      white-space: nowrap;
      padding: 4px 8px;
      border-radius: 6px;
      pointer-events: none;
      opacity: 0;
      transform: translateY(4px);
      transition: opacity 0.15s, transform 0.15s;
      font-family: var(--font);
    }
    .theme-toggle:hover::before { opacity: 1; transform: translateY(0); }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       WRAPPER
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .wrapper {
      position: relative; z-index: 1;
      max-width: 1320px;
      margin: 0 auto;
      padding: 0 20px 60px;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       HERO
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .hero {
      text-align: center;
      padding: 52px 16px 40px;
      animation: fadeSlideUp 0.6s cubic-bezier(.22,1,.36,1) both;
    }
    @keyframes fadeSlideUp {
      from { opacity: 0; transform: translateY(24px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    .hero-eyebrow {
      display: inline-flex; align-items: center; gap: 6px;
      font-size: 11px; font-weight: 600;
      letter-spacing: 1.5px; text-transform: uppercase;
      color: var(--accent);
      background: rgba(var(--accent-rgb),0.10);
      border: 1px solid rgba(var(--accent-rgb),0.25);
      padding: 4px 12px; border-radius: 100px;
      margin-bottom: 20px;
      transition: background 0.3s, color 0.3s;
    }
    .hero-title {
      font-size: clamp(26px, 5vw, 38px);
      font-weight: 700; line-height: 1.15; letter-spacing: -1px;
      margin-bottom: 16px; transition: color 0.3s;
    }
    .gradient-text {
      background: linear-gradient(135deg, var(--accent) 0%, var(--accent-2) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .hero-sub {
      font-size: 15px; color: var(--text-muted);
      max-width: 500px; margin: 0 auto 36px; line-height: 1.7;
      transition: color 0.3s;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       FILTER BAR
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .filter-bar {
      display: flex; gap: 12px; align-items: center;
      max-width: 700px; margin: 0 auto 44px;
      flex-wrap: wrap;
      animation: fadeSlideUp 0.6s 0.1s cubic-bezier(.22,1,.36,1) both;
    }
    .search-wrap { flex: 1; min-width: 200px; position: relative; }
    .search-icon {
      position: absolute; left: 14px; top: 50%;
      transform: translateY(-50%);
      color: var(--text-muted); font-size: 16px; pointer-events: none;
    }
    .search-input {
      width: 100%;
      padding: 11px 16px 11px 40px;
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-md);
      color: var(--text);
      font-family: var(--font); font-size: 13px;
      outline: none;
      transition: border-color 0.2s, box-shadow 0.2s, background 0.3s, color 0.3s;
      backdrop-filter: blur(var(--blur));
      -webkit-backdrop-filter: blur(var(--blur));
    }
    .search-input::placeholder { color: var(--text-muted); }
    .search-input:focus {
      border-color: var(--accent);
      background: var(--glass-bg-h);
      box-shadow: 0 0 0 3px rgba(var(--accent-rgb),0.15);
    }
    .filter-select {
      padding: 11px 36px 11px 14px;
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-md);
      color: var(--text);
      font-family: var(--font); font-size: 13px;
      outline: none; cursor: pointer;
      transition: border-color 0.2s, background 0.3s, color 0.3s;
      backdrop-filter: blur(var(--blur));
      -webkit-backdrop-filter: blur(var(--blur));
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' fill='none'%3E%3Cpath d='M1 1l5 5 5-5' stroke='rgba(150,130,220,0.7)' stroke-width='1.5' stroke-linecap='round'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 12px center;
      min-width: 160px;
    }
    .filter-select option { background: #1a1040; color: #fff; }
    [data-theme="light"] .filter-select option { background: #f0eeff; color: #0f0a28; }
    .filter-select:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(var(--accent-rgb),0.15);
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       CATEGORY
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .category-section {
      margin-bottom: 48px;
      opacity: 0; transform: translateY(20px);
      transition: opacity 0.5s ease, transform 0.5s cubic-bezier(.22,1,.36,1);
    }
    .category-section.visible { opacity: 1; transform: translateY(0); }
    [data-theme="win95"] .category-section { opacity: 1 !important; transform: none !important; }

    .category-header {
      display: flex; align-items: center;
      gap: 12px; margin-bottom: 20px;
    }
    .category-label {
      font-size: 11px; font-weight: 700;
      letter-spacing: 1.2px; color: var(--text-muted);
      text-transform: uppercase; white-space: nowrap;
      transition: color 0.3s;
    }
    .category-line { flex: 1; height: 1px; background: var(--glass-border); transition: background 0.3s; }
    .category-count {
      font-size: 10px; font-weight: 700;
      color: var(--accent);
      background: rgba(var(--accent-rgb),0.12);
      border: 1px solid rgba(var(--accent-rgb),0.20);
      padding: 2px 9px; border-radius: 100px;
      transition: background 0.3s, color 0.3s;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       GLASS APP CARD
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .app-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
    }
    .app-card {
      position: relative;
      border-radius: var(--radius-lg);
      background: var(--glass-bg);
      backdrop-filter: blur(var(--blur));
      -webkit-backdrop-filter: blur(var(--blur));
      border: 1px solid var(--glass-border);
      box-shadow: var(--sh-card);
      padding: 20px; cursor: pointer;
      transition: transform var(--trans), box-shadow var(--trans),
                  border-color var(--trans), background var(--trans);
      overflow: hidden;
      opacity: 0;
    }
    .app-card.card-visible { animation: cardIn 0.45s cubic-bezier(.22,1,.36,1) both; opacity: 1; }
    @keyframes cardIn {
      from { opacity: 0; transform: translateY(18px) scale(0.97); }
      to   { opacity: 1; transform: translateY(0) scale(1); }
    }
    .app-card::before {
      content: ''; position: absolute;
      top: 0; left: 0; right: 0; height: 1px;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.18) 40%, rgba(255,255,255,0.10) 70%, transparent);
      pointer-events: none;
    }
    .app-card::after {
      content: ''; position: absolute; inset: 0;
      border-radius: var(--radius-lg);
      background: radial-gradient(ellipse 80% 60% at 50% 120%, rgba(var(--accent-rgb),0.10) 0%, transparent 70%);
      opacity: 0; transition: opacity var(--trans); pointer-events: none;
    }
    .app-card:hover {
      transform: translateY(-5px) scale(1.01);
      box-shadow: var(--sh-hover);
      border-color: var(--glass-bdr-h);
      background: var(--glass-bg-h);
    }
    .app-card:hover::after { opacity: 1; }
    .app-card:active { transform: translateY(-2px) scale(1.005); }

    .app-card.featured {
      border-color: rgba(var(--accent-rgb),0.38);
      box-shadow: var(--sh-card), 0 0 30px rgba(var(--accent-rgb),0.08);
    }
    .featured-badge {
      position: absolute; top: 14px; right: 14px;
      font-size: 9px; font-weight: 700;
      letter-spacing: 0.8px; text-transform: uppercase;
      color: var(--accent);
      background: rgba(var(--accent-rgb),0.14);
      border: 1px solid rgba(var(--accent-rgb),0.28);
      padding: 2px 8px; border-radius: 100px;
    }

    .card-top { display: flex; align-items: flex-start; gap: 12px; margin-bottom: 12px; }
    .app-icon-wrap {
      width: 44px; height: 44px;
      border-radius: var(--radius-sm); overflow: hidden;
      flex-shrink: 0;
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      transition: background 0.3s, border-color 0.3s;
    }
    .app-icon {
      width: 44px; height: 44px; object-fit: contain; display: block;
      transition: transform var(--trans);
    }
    .app-card:hover .app-icon { transform: scale(1.08); }
    .app-icon.loading {
      background: linear-gradient(90deg, var(--skel-from) 0%, var(--skel-to) 50%, var(--skel-from) 100%);
      background-size: 200% 100%;
      animation: shimmer 1.5s ease-in-out infinite;
    }
    @keyframes shimmer { 0%{background-position:-100% 0} 100%{background-position:100% 0} }

    .card-title-wrap { flex: 1; min-width: 0; padding-top: 2px; }
    .app-name {
      font-size: 15px; font-weight: 600; color: var(--text);
      white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
      margin-bottom: 3px; transition: color 0.3s;
    }
    .app-cat-label { font-size: 11px; color: var(--text-muted); transition: color 0.3s; }
    .app-desc {
      font-size: 13px; color: var(--text-muted); line-height: 1.58;
      margin-bottom: 12px;
      display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;
      transition: color 0.3s;
    }

    .tags-row { display: flex; flex-wrap: wrap; gap: 4px; margin-bottom: 16px; min-height: 22px; }
    .tag {
      font-size: 10px; font-weight: 500;
      padding: 2px 8px; border-radius: 100px;
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(255,255,255,0.10);
      color: var(--text-muted); white-space: nowrap;
      transition: background 0.2s, color 0.3s;
    }
    [data-theme="light"] .tag { background: rgba(80,60,180,0.07); border-color: rgba(80,60,180,0.12); }
    .tag.pricing { font-weight: 600; border-color: transparent; color: #fff; }
    .tag.pricing.free     { background: rgba(34,197,94,0.28);  border-color: rgba(34,197,94,0.40); }
    .tag.pricing.paid     { background: rgba(239,68,68,0.25);   border-color: rgba(239,68,68,0.38); }
    .tag.pricing.freemium { background: rgba(56,189,248,0.25);  border-color: rgba(56,189,248,0.38); }
    .tag.pricing.trial    { background: rgba(251,191,36,0.28);  border-color: rgba(251,191,36,0.42); }
    .tag.pricing.unknown  { background: rgba(148,163,184,0.22); border-color: rgba(148,163,184,0.32); }

    .card-footer {
      display: flex; align-items: center; justify-content: space-between;
      padding-top: 14px; border-top: 1px solid var(--glass-border);
      transition: border-color 0.3s;
    }
    .rating-display { display: flex; align-items: center; gap: 4px; font-size: 11px; color: var(--text-muted); }
    .rating-display .star { color: #fbbf24; font-size: 12px; }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       WIN95 CARDS (injected by JS)
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .win95-card {
      cursor: pointer;
      transition: none !important;
      opacity: 1 !important;
    }
    .win95-card .window-body { background: #f0f0f0; padding: 8px; }
    .win95-card:hover { filter: brightness(1.02); }
    .win95-tag {
      font-size: 9px; padding: 1px 5px;
      background: #c0c0c0;
      border: 1px solid #808080;
      white-space: nowrap;
      margin-right: 3px;
    }
    .win95-pricing {
      font-size: 9px; padding: 1px 5px; font-weight: bold;
      white-space: nowrap; margin-right: 3px;
    }
    .win95-pricing.free     { background: #008000; color: #fff; border: 1px solid #006000; }
    .win95-pricing.paid     { background: #800000; color: #fff; border: 1px solid #600000; }
    .win95-pricing.freemium { background: #000080; color: #fff; border: 1px solid #000060; }
    .win95-pricing.unknown  { background: #808080; color: #fff; border: 1px solid #606060; }
    .win95-upvote-btn { padding: 2px 8px; cursor: pointer; font-size: 11px; }
    .win95-upvote-btn.upvoted { background: navy; color: white; }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       BUTTONS (glass)
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .btn {
      display: inline-flex; align-items: center; gap: 4px;
      font-family: var(--font); font-size: 11px; font-weight: 600;
      padding: 6px 14px; border-radius: var(--radius-sm);
      border: 1px solid var(--glass-border);
      background: var(--glass-bg); color: var(--text-muted);
      cursor: pointer;
      transition: background var(--trans), border-color var(--trans),
                  color var(--trans), transform 0.14s ease;
      white-space: nowrap; user-select: none; position: relative; overflow: hidden;
    }
    .btn::after {
      content: ''; position: absolute; inset: 0;
      background: radial-gradient(circle at center, rgba(255,255,255,0.18) 0%, transparent 70%);
      opacity: 0; transition: opacity 0.3s; pointer-events: none;
    }
    .btn:active::after { opacity: 1; }
    .btn:hover { background: var(--glass-bg-h); border-color: rgba(255,255,255,0.20); color: var(--text); transform: translateY(-1px); }
    .btn:active { transform: translateY(0) scale(0.97); }
    .btn.upvoted { background: rgba(var(--accent-rgb),0.16); border-color: rgba(var(--accent-rgb),0.42); color: var(--accent); }
    .btn-primary {
      background: linear-gradient(135deg, rgba(124,58,237,0.70), rgba(56,189,248,0.50));
      border-color: rgba(var(--accent-rgb),0.50);
      color: #fff; padding: 10px 22px; font-size: 13px; border-radius: var(--radius-md);
    }
    .btn-primary:hover {
      background: linear-gradient(135deg, rgba(124,58,237,0.90), rgba(56,189,248,0.70));
      border-color: rgba(var(--accent-rgb),0.80);
      box-shadow: 0 4px 20px rgba(var(--accent-rgb),0.35); color: #fff;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SKELETONS
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .skeleton-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-bottom: 48px; }
    .skeleton-card { border-radius: var(--radius-lg); background: var(--glass-bg); border: 1px solid var(--glass-border); padding: 20px; display: flex; flex-direction: column; gap: 12px; }
    .skel { border-radius: 6px; background: linear-gradient(90deg, var(--skel-from) 0%, var(--skel-to) 50%, var(--skel-from) 100%); background-size: 200% 100%; animation: shimmer 1.5s ease-in-out infinite; }
    .skel-row { display: flex; gap: 12px; align-items: center; }
    .skel-icon { width: 44px; height: 44px; border-radius: var(--radius-sm); flex-shrink: 0; }
    .skel-lines { flex: 1; display: flex; flex-direction: column; gap: 8px; }
    .skel-line { height: 10px; }
    .skel-line.w60 { width: 60%; } .skel-line.w40 { width: 40%; } .skel-line.w80 { width: 80%; } .skel-line.w100 { width: 100%; }
    .skel-tags { display: flex; gap: 6px; }
    .skel-tag { height: 18px; width: 52px; border-radius: 100px; }
    .skel-footer { display: flex; justify-content: space-between; padding-top: 12px; border-top: 1px solid var(--glass-border); }
    .skel-btn { height: 28px; width: 70px; border-radius: var(--radius-sm); }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MODAL (glass)
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .modal-backdrop {
      display: none; position: fixed; inset: 0;
      background: rgba(0,0,0,0.50); z-index: 200;
      backdrop-filter: blur(5px); -webkit-backdrop-filter: blur(5px);
      animation: fadeIn 0.2s ease;
    }
    .modal-backdrop.active { display: block; }
    @keyframes fadeIn { from{opacity:0} to{opacity:1} }

    .modal {
      display: none; position: fixed;
      top: 50%; left: 50%;
      transform: translate(-50%,-48%) scale(0.93);
      width: 92%; max-width: 600px; max-height: 88vh;
      z-index: 201;
      border-radius: var(--radius-xl);
      background: var(--glass-modal);
      backdrop-filter: blur(var(--blur-modal));
      -webkit-backdrop-filter: blur(var(--blur-modal));
      border: 1px solid var(--glass-border);
      box-shadow: var(--sh-modal);
      overflow: hidden; flex-direction: column;
      opacity: 0;
      transition: transform 0.30s cubic-bezier(.22,1,.36,1), opacity 0.22s ease;
    }
    .modal.active { display: flex; transform: translate(-50%,-50%) scale(1); opacity: 1; }
    .modal::before {
      content: ''; position: absolute; top: 0; left: 0; right: 0; height: 1px;
      background: linear-gradient(90deg, transparent, rgba(var(--accent-rgb),0.7) 35%, rgba(56,189,248,0.6) 65%, transparent);
      pointer-events: none;
    }

    .modal-header {
      display: flex; align-items: center; justify-content: space-between;
      padding: 20px 24px 16px;
      border-bottom: 1px solid var(--glass-border);
      flex-shrink: 0; transition: border-color 0.3s;
    }
    .modal-title-row { display: flex; align-items: center; gap: 12px; }
    .modal-icon-wrap {
      width: 50px; height: 50px; border-radius: var(--radius-md);
      overflow: hidden; background: var(--glass-bg);
      border: 1px solid var(--glass-border); flex-shrink: 0;
    }
    .modal-icon { width: 50px; height: 50px; object-fit: contain; display: block; }
    .modal-name { font-size: 20px; font-weight: 700; letter-spacing: -0.3px; color: var(--text); transition: color 0.3s; }
    .modal-meta { font-size: 11px; color: var(--text-muted); margin-top: 3px; transition: color 0.3s; }
    .modal-close {
      width: 32px; height: 32px; border-radius: 50%;
      background: var(--glass-bg); border: 1px solid var(--glass-border);
      color: var(--text-muted); font-size: 15px; cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      transition: background var(--trans), color var(--trans), border-color var(--trans), transform 0.15s;
      flex-shrink: 0;
    }
    .modal-close:hover { background: rgba(239,68,68,0.20); border-color: rgba(239,68,68,0.40); color: #fff; transform: rotate(90deg) scale(1.1); }

    .modal-body { overflow-y: auto; padding: 20px 24px; flex: 1; }
    .modal-body::-webkit-scrollbar { width: 4px; }
    .modal-body::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.15); border-radius: 2px; }
    .modal-section { margin-bottom: 20px; }
    .modal-desc { font-size: 13px; color: var(--text-muted); line-height: 1.72; transition: color 0.3s; }
    .modal-avg {
      display: inline-flex; align-items: center; gap: 6px;
      font-size: 12px; color: var(--text-muted);
      background: var(--glass-bg); border: 1px solid var(--glass-border);
      padding: 5px 12px; border-radius: 100px; margin-top: 8px;
    }
    .modal-avg .star { color: #fbbf24; }
    .modal-footer {
      padding: 16px 24px; border-top: 1px solid var(--glass-border);
      display: flex; align-items: center; justify-content: space-between;
      gap: 12px; flex-shrink: 0; flex-wrap: wrap;
    }
    .rate-label { font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.8px; color: var(--text-faint); margin-bottom: 4px; }
    .star-group { display: flex; gap: 3px; }
    .star-btn { background: none; border: none; font-size: 22px; cursor: pointer; color: var(--text-faint); transition: color 0.15s, transform 0.15s; padding: 0 1px; line-height: 1; }
    .star-btn:hover { transform: scale(1.25) rotate(-5deg); }
    .star-btn.filled { color: #fbbf24; }

    /* WIN95 modal overrides */
    [data-theme="win95"] .modal {
      border-radius: 0 !important;
      background: #c0c0c0 !important;
      backdrop-filter: none !important;
      border: 2px solid !important;
      border-color: #ffffff #808080 #808080 #ffffff !important;
      box-shadow: 4px 4px 0 #000 !important;
    }
    [data-theme="win95"] .modal::before { display: none !important; }
    [data-theme="win95"] .modal-backdrop { backdrop-filter: none !important; }
    [data-theme="win95"] .modal-header {
      background: linear-gradient(90deg, #000080, #1084d0) !important;
      border-bottom: 2px solid #808080 !important;
      padding: 6px 8px !important;
    }
    [data-theme="win95"] .modal-name { color: #fff !important; font-family: Arial, sans-serif !important; font-size: 14px !important; }
    [data-theme="win95"] .modal-meta { color: rgba(255,255,255,0.8) !important; }
    [data-theme="win95"] .modal-icon-wrap { border-radius: 0 !important; border: 1px inset #808080 !important; background: #fff !important; }
    [data-theme="win95"] .modal-close {
      border-radius: 0 !important; background: #c0c0c0 !important;
      border: 2px solid !important; border-color: #ffffff #808080 #808080 #ffffff !important;
      color: #000 !important; font-size: 12px !important;
      box-shadow: none !important;
    }
    [data-theme="win95"] .modal-close:hover { background: #c0c0c0 !important; transform: none !important; }
    [data-theme="win95"] .modal-body { background: #f0f0f0; color: #000 !important; }
    [data-theme="win95"] .modal-desc { color: #000 !important; font-family: Arial, sans-serif !important; font-size: 12px !important; }
    [data-theme="win95"] .modal-footer { background: #c0c0c0; border-top: 2px solid #808080 !important; }
    [data-theme="win95"] .modal-avg { background: #e0e0e0 !important; border: 1px inset #808080 !important; color: #000 !important; }
    [data-theme="win95"] .rate-label { color: #000 !important; font-family: Arial, sans-serif !important; }
    [data-theme="win95"] .star-btn { color: #808080 !important; }
    [data-theme="win95"] .star-btn.filled { color: #ffaa00 !important; }
    [data-theme="win95"] .btn-primary {
      background: #c0c0c0 !important;
      border: 2px solid !important;
      border-color: #ffffff #808080 #808080 #ffffff !important;
      color: #000 !important;
      border-radius: 0 !important;
      font-family: Arial, sans-serif !important;
    }
    [data-theme="win95"] .btn {
      background: #c0c0c0 !important;
      border: 2px solid !important;
      border-color: #ffffff #808080 #808080 #ffffff !important;
      color: #000 !important; border-radius: 0 !important;
      font-family: Arial, sans-serif !important;
    }
    [data-theme="win95"] .btn.upvoted { background: navy !important; color: #fff !important; }
    [data-theme="win95"] .tags-row .tag {
      background: #c0c0c0 !important; border: 1px solid #808080 !important;
      color: #000 !important; border-radius: 0 !important;
    }
    [data-theme="win95"] .tags-row .tag.pricing { color: #fff !important; }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       EMPTY / FOOTER
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .empty-state { text-align: center; padding: 60px 16px; color: var(--text-muted); animation: fadeSlideUp 0.4s ease both; }
    .empty-icon { font-size: 52px; margin-bottom: 16px; opacity: 0.5; }
    .site-footer {
      text-align: center; padding: 32px 16px;
      border-top: 1px solid var(--glass-border);
      margin-top: 48px; color: var(--text-faint); font-size: 12px;
      transition: border-color 0.3s, color 0.3s;
    }
    .site-footer a { color: var(--accent); text-decoration: none; }
    .site-footer a:hover { color: var(--accent-2); }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCROLLBAR / RESPONSIVE
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    ::-webkit-scrollbar { width: 5px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: rgba(var(--accent-rgb),0.20); border-radius: 3px; }

    @media (max-width: 640px) {
      .navbar-stats { display: none; }
      .filter-bar { flex-direction: column; }
      .filter-select { width: 100%; }
      .app-grid, .skeleton-grid { grid-template-columns: 1fr; }
      .modal-footer { flex-direction: column; align-items: flex-start; }
      .hero { padding: 32px 12px 28px; }
    }

    @supports not (backdrop-filter: blur(1px)) {
      .app-card, .navbar, .filter-select, .search-input, .modal { background: rgba(20,14,50,0.92) !important; }
      [data-theme="light"] .app-card, [data-theme="light"] .navbar,
      [data-theme="light"] .filter-select, [data-theme="light"] .search-input,
      [data-theme="light"] .modal { background: rgba(248,246,255,0.97) !important; }
    }
  </style>
</head>
<body>

<canvas id="bg-canvas"></canvas>
<div class="orb orb-1" id="orb1"></div>
<div class="orb orb-2" id="orb2"></div>

<!-- â”€â”€ NAVBAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<nav class="navbar">
  <a class="navbar-brand" href="#">
    <img src="logo.svg" alt="CuratedStack" id="nav-logo" onerror="this.style.display='none'">
    <span class="brand-gradient">CuratedStack</span>
  </a>
  <div class="navbar-right">
    <div class="navbar-stats">
      <span><strong id="nav-count">â€”</strong> apps</span>
      <span><strong id="nav-upvotes">â€”</strong> upvotes</span>
      <span>avg <strong id="nav-rating">â€”</strong>â­</span>
    </div>
    <button class="theme-toggle" id="theme-toggle" aria-label="Switch theme" data-tip="Switch theme"></button>
  </div>
</nav>

<!-- â”€â”€ MAIN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div class="wrapper">

  <div class="hero">
    <div class="hero-eyebrow">âœ¦ Curated by Boe</div>
    <h1 class="hero-title">The best apps &amp; tools,<br><span class="gradient-text">hand-picked for you</span></h1>
    <p class="hero-sub">A living directory of AI tools, dev resources, and tech products worth your attention â€” updated constantly.</p>
  </div>

  <div class="filter-bar">
    <div class="search-wrap">
      <span class="search-icon">âŒ•</span>
      <input id="search-input" class="search-input" type="text" placeholder="Search apps, tagsâ€¦" autocomplete="off"/>
    </div>
    <select id="category-filter" class="filter-select">
      <option value="all">All Categories</option>
    </select>
  </div>

  <div id="app-container">
    <div class="skeleton-grid" id="skeleton">
      <div class="skeleton-card"><div class="skel-row"><div class="skel skel-icon"></div><div class="skel-lines"><div class="skel skel-line w60"></div><div class="skel skel-line w40"></div></div></div><div class="skel skel-line w100"></div><div class="skel skel-line w80"></div><div class="skel-tags"><div class="skel skel-tag"></div><div class="skel skel-tag"></div><div class="skel skel-tag"></div></div><div class="skel-footer"><div class="skel skel-btn"></div><div class="skel skel-btn"></div></div></div>
      <div class="skeleton-card"><div class="skel-row"><div class="skel skel-icon"></div><div class="skel-lines"><div class="skel skel-line w60"></div><div class="skel skel-line w40"></div></div></div><div class="skel skel-line w100"></div><div class="skel skel-line w80"></div><div class="skel-tags"><div class="skel skel-tag"></div><div class="skel skel-tag"></div><div class="skel skel-tag"></div></div><div class="skel-footer"><div class="skel skel-btn"></div><div class="skel skel-btn"></div></div></div>
      <div class="skeleton-card"><div class="skel-row"><div class="skel skel-icon"></div><div class="skel-lines"><div class="skel skel-line w60"></div><div class="skel skel-line w40"></div></div></div><div class="skel skel-line w100"></div><div class="skel skel-line w80"></div><div class="skel-tags"><div class="skel skel-tag"></div><div class="skel skel-tag"></div><div class="skel skel-tag"></div></div><div class="skel-footer"><div class="skel skel-btn"></div><div class="skel skel-btn"></div></div></div>
      <div class="skeleton-card"><div class="skel-row"><div class="skel skel-icon"></div><div class="skel-lines"><div class="skel skel-line w60"></div><div class="skel skel-line w40"></div></div></div><div class="skel skel-line w100"></div><div class="skel skel-line w80"></div><div class="skel-tags"><div class="skel skel-tag"></div><div class="skel skel-tag"></div><div class="skel skel-tag"></div></div><div class="skel-footer"><div class="skel skel-btn"></div><div class="skel skel-btn"></div></div></div>
      <div class="skeleton-card"><div class="skel-row"><div class="skel skel-icon"></div><div class="skel-lines"><div class="skel skel-line w60"></div><div class="skel skel-line w40"></div></div></div><div class="skel skel-line w100"></div><div class="skel skel-line w80"></div><div class="skel-tags"><div class="skel skel-tag"></div><div class="skel skel-tag"></div><div class="skel skel-tag"></div></div><div class="skel-footer"><div class="skel skel-btn"></div><div class="skel skel-btn"></div></div></div>
      <div class="skeleton-card"><div class="skel-row"><div class="skel skel-icon"></div><div class="skel-lines"><div class="skel skel-line w60"></div><div class="skel skel-line w40"></div></div></div><div class="skel skel-line w100"></div><div class="skel skel-line w80"></div><div class="skel-tags"><div class="skel skel-tag"></div><div class="skel skel-tag"></div><div class="skel skel-tag"></div></div><div class="skel-footer"><div class="skel skel-btn"></div><div class="skel skel-btn"></div></div></div>
    </div>
  </div>
</div>

<footer class="site-footer">CuratedStack Â· Built with â™¥ Â· <a href="#">About</a></footer>

<div class="modal-backdrop" id="modal-backdrop"></div>
<div class="modal" id="modal">
  <div class="modal-header">
    <div class="modal-title-row">
      <div class="modal-icon-wrap"><img class="modal-icon" id="modal-icon" src="" alt="" onerror="this.src='logo.svg'"></div>
      <div><div class="modal-name" id="modal-name">â€”</div><div class="modal-meta" id="modal-meta">â€”</div></div>
    </div>
    <button class="modal-close" id="modal-close" aria-label="Close">âœ•</button>
  </div>
  <div class="modal-body" id="modal-body"></div>
  <div class="modal-footer" id="modal-footer"></div>
</div>

<script>
/* â”€â”€â”€ CONFIG â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const SUPABASE_URL = 'https://jereytrwxnuwcvzvqhbg.supabase.co'
const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImplcmV5dHJ3eG51d2N2enZxaGJnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA5MjI1NzksImV4cCI6MjA4NjQ5ODU3OX0.r0RDnh75IGjECXMwMJNZR0oqF-cEubxbQbjXgavsJ_I'

/* â”€â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
let allApps = []
let currentCategory = 'all'
let currentSearch   = ''

/* â”€â”€â”€ THEME ENGINE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const THEMES = ['dark', 'light', 'win95']
const THEME_ICONS = { dark: 'ğŸŒ™', light: 'â˜€ï¸', win95: 'ğŸ–¥ï¸' }
const THEME_TIPS  = { dark: 'Switch to Light', light: 'Switch to Win95', win95: 'Switch to Dark' }

const html     = document.documentElement
const themeBtn = document.getElementById('theme-toggle')
let theme = localStorage.getItem('cs-theme') || 'dark'
let win95Link = null

function applyTheme(t) {
  theme = t
  html.setAttribute('data-theme', t)
  themeBtn.textContent = THEME_ICONS[t]
  themeBtn.setAttribute('data-tip', THEME_TIPS[t])
  localStorage.setItem('cs-theme', t)

  if (t === 'win95') {
    loadWin95CSS()
  } else {
    unloadWin95CSS()
  }

  // Re-render so correct card template is used
  if (allApps.length) renderApps()
}

function loadWin95CSS() {
  if (document.getElementById('win95-css')) return
  win95Link = document.createElement('link')
  win95Link.rel = 'stylesheet'
  win95Link.id  = 'win95-css'
  win95Link.href = 'https://unpkg.com/98.css'
  document.head.appendChild(win95Link)
}

function unloadWin95CSS() {
  const el = document.getElementById('win95-css')
  if (el) el.remove()
  win95Link = null
}

applyTheme(theme)

themeBtn.addEventListener('click', () => {
  const idx = THEMES.indexOf(theme)
  applyTheme(THEMES[(idx + 1) % THEMES.length])
})

/* â”€â”€â”€ PARALLAX â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const orb1 = document.getElementById('orb1')
const orb2 = document.getElementById('orb2')
let rafP = false
document.addEventListener('mousemove', e => {
  if (theme === 'win95') return
  const x = e.clientX / window.innerWidth  - 0.5
  const y = e.clientY / window.innerHeight - 0.5
  if (!rafP) {
    rafP = true
    requestAnimationFrame(() => {
      orb1.style.transform = `translate(${x*30}px,${y*20}px)`
      orb2.style.transform = `translate(${-x*25}px,${-y*18}px)`
      rafP = false
    })
  }
})

/* â”€â”€â”€ HELPERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function getFavicon(url) {
  try { return `https://www.google.com/s2/favicons?domain=${new URL(url).hostname}&sz=64` }
  catch { return 'logo.svg' }
}
function getPricingClass(p) {
  const s = (p || '').toLowerCase()
  if (s.includes('free') && s.includes('paid')) return 'freemium'
  if (s.includes('freemium')) return 'freemium'
  if (s === 'free' || s.includes('free')) return 'free'
  if (s.includes('paid'))  return 'paid'
  if (s.includes('trial')) return 'trial'
  return 'unknown'
}

/* â”€â”€â”€ GLASS CARD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function createCard(app, delay = 0) {
  if (theme === 'win95') return createCardWin95(app)
  const upvoted = !!localStorage.getItem(`upvoted_${app.id}`)
  const avg     = app.rating_count > 0 ? (app.rating_sum / app.rating_count).toFixed(1) : null
  const favicon = app.logo_url || getFavicon(app.url)
  const pricing = app.pricing_model ? `<span class="tag pricing ${getPricingClass(app.pricing_model)}">${app.pricing_model}</span>` : ''
  const tags    = (app.tags || []).slice(0, 3).map(t => `<span class="tag">${t}</span>`).join('')
  const rating  = avg ? `<span class="star">â˜…</span>${avg}` : '<span style="opacity:.35">no ratings</span>'
  return `
    <div class="app-card ${app.featured ? 'featured' : ''}" data-id="${app.id}"
         style="animation-delay:${delay}ms" onclick="openModal('${app.id}')">
      ${app.featured ? '<div class="featured-badge">â­ Featured</div>' : ''}
      <div class="card-top">
        <div class="app-icon-wrap">
          <img class="app-icon loading" src="${favicon}" alt="${app.name}"
               onload="this.classList.remove('loading')" onerror="this.src='logo.svg';this.classList.remove('loading')">
        </div>
        <div class="card-title-wrap">
          <div class="app-name">${app.name}</div>
          <div class="app-cat-label">${app.category || 'Other'}</div>
        </div>
      </div>
      <p class="app-desc">${app.description || 'No description available.'}</p>
      <div class="tags-row">${pricing}${tags}</div>
      <div class="card-footer">
        <button class="btn ${upvoted ? 'upvoted' : ''}"
                onclick="event.stopPropagation();handleUpvote('${app.id}',this)">ğŸ‘ <span>${app.upvotes||0}</span></button>
        <div class="rating-display">${rating}</div>
      </div>
    </div>`
}

/* â”€â”€â”€ WIN95 CARD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function createCardWin95(app) {
  const upvoted = !!localStorage.getItem(`upvoted_${app.id}`)
  const avg     = app.rating_count > 0 ? (app.rating_sum / app.rating_count).toFixed(1) : null
  const favicon = app.logo_url || getFavicon(app.url)
  const pc      = getPricingClass(app.pricing_model)
  const pricing = app.pricing_model
    ? `<span class="win95-pricing ${pc}">${app.pricing_model.toUpperCase()}</span>` : ''
  const tags    = (app.tags || []).slice(0, 3).map(t => `<span class="win95-tag">${t}</span>`).join('')
  return `
    <div class="window win95-card" data-id="${app.id}" onclick="openModal('${app.id}')">
      <div class="title-bar">
        <div class="title-bar-text">
          <img src="${favicon}" style="width:14px;height:14px;object-fit:contain;vertical-align:middle;margin-right:4px" onerror="this.style.display='none'">
          ${app.name}
        </div>
        <div class="title-bar-controls">
          <button aria-label="Minimize" disabled></button>
          <button aria-label="Close" disabled></button>
        </div>
      </div>
      <div class="window-body" style="padding:8px">
        <p style="font-size:11px;margin:0 0 6px;line-height:1.4;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden">${app.description || 'No description.'}</p>
        <div style="display:flex;gap:3px;flex-wrap:wrap;margin-bottom:8px">${pricing}${tags}</div>
        <div style="display:flex;justify-content:space-between;align-items:center;border-top:1px solid #808080;padding-top:6px">
          <button class="win95-upvote-btn ${upvoted ? 'upvoted' : ''}"
                  onclick="event.stopPropagation();handleUpvote('${app.id}',this)">ğŸ‘ <span>${app.upvotes||0}</span></button>
          <span style="font-size:11px;color:#444">${avg ? `â˜… ${avg}` : 'No ratings'}</span>
        </div>
      </div>
    </div>`
}

/* â”€â”€â”€ INTERSECTION OBSERVER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const cardObserver = new IntersectionObserver(entries => {
  entries.forEach(e => { if (e.isIntersecting) { e.target.classList.add('card-visible'); cardObserver.unobserve(e.target) } })
}, { threshold: 0.06 })

const catObserver = new IntersectionObserver(entries => {
  entries.forEach(e => { if (e.isIntersecting) { e.target.classList.add('visible'); catObserver.unobserve(e.target) } })
}, { threshold: 0.04 })

function observeCards() {
  document.querySelectorAll('.app-card:not(.card-visible)').forEach(c => cardObserver.observe(c))
  document.querySelectorAll('.category-section:not(.visible)').forEach(c => catObserver.observe(c))
}

/* â”€â”€â”€ MODAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function openModal(id) {
  const app = allApps.find(a => a.id === id)
  if (!app) return

  const userRating = parseInt(localStorage.getItem(`rated_${app.id}`)) || 0
  const hasUpvoted = !!localStorage.getItem(`upvoted_${app.id}`)
  const avg     = app.rating_count > 0 ? (app.rating_sum / app.rating_count).toFixed(1) : null
  const favicon = app.logo_url || getFavicon(app.url)
  const pc      = getPricingClass(app.pricing_model)
  const fullDesc = app.detailed_description || app.description || 'No description available.'

  document.getElementById('modal-icon').src = favicon
  document.getElementById('modal-icon').alt = app.name
  document.getElementById('modal-name').textContent = app.name
  document.getElementById('modal-meta').textContent = app.category || 'Uncategorized'

  const pricingHtml = theme === 'win95'
    ? (app.pricing_model ? `<span class="win95-pricing ${pc}">${app.pricing_model.toUpperCase()}</span>` : '')
    : (app.pricing_model ? `<span class="tag pricing ${pc}">${app.pricing_model}</span>` : '')

  const tagsHtml = theme === 'win95'
    ? (app.tags || []).map(t => `<span class="win95-tag">${t}</span>`).join('')
    : (app.tags || []).map(t => `<span class="tag">${t}</span>`).join('')

  document.getElementById('modal-body').innerHTML = `
    <div class="modal-section">
      <div class="tags-row" style="margin-bottom:16px">${pricingHtml}${tagsHtml}</div>
      <p class="modal-desc">${fullDesc}</p>
      ${avg ? `<div class="modal-avg"><span class="star">â˜…</span><strong>${avg}</strong><span style="opacity:.6">Â· ${app.rating_count} reviews</span></div>` : ''}
    </div>`

  document.getElementById('modal-footer').innerHTML = `
    <button class="btn ${hasUpvoted ? 'upvoted' : ''}" onclick="handleUpvote('${app.id}',this)">ğŸ‘ <span>${app.upvotes||0}</span></button>
    <div style="text-align:center">
      <div class="rate-label">Rate this app</div>
      <div class="star-group">
        ${[1,2,3,4,5].map(i => `<button class="star-btn ${userRating>=i?'filled':''}" onclick="handleRating('${app.id}',${i},this)">${userRating>=i?'â˜…':'â˜†'}</button>`).join('')}
      </div>
    </div>
    <a href="${app.url}" target="_blank" rel="noopener noreferrer" onclick="event.stopPropagation()">
      <button class="btn btn-primary">Visit â†’</button>
    </a>`

  document.getElementById('modal-backdrop').classList.add('active')
  document.getElementById('modal').offsetHeight
  document.getElementById('modal').classList.add('active')
  document.body.style.overflow = 'hidden'
}

function closeModal() {
  const m = document.getElementById('modal')
  m.style.opacity = '0'
  m.style.transform = 'translate(-50%,-52%) scale(0.94)'
  setTimeout(() => {
    m.classList.remove('active')
    m.style.opacity = m.style.transform = ''
    document.getElementById('modal-backdrop').classList.remove('active')
    document.body.style.overflow = ''
  }, 220)
}

document.getElementById('modal-close').addEventListener('click', closeModal)
document.getElementById('modal-backdrop').addEventListener('click', closeModal)
document.addEventListener('keydown', e => { if (e.key === 'Escape') closeModal() })

/* â”€â”€â”€ UPVOTE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
async function handleUpvote(appId, btn) {
  if (localStorage.getItem(`upvoted_${appId}`)) return
  const span = btn.querySelector('span')
  btn.style.transform = 'scale(1.2)'
  setTimeout(() => btn.style.transform = '', 200)
  span.textContent = parseInt(span.textContent) + 1
  btn.classList.add('upvoted')
  localStorage.setItem(`upvoted_${appId}`, '1')
  const app = allApps.find(a => a.id === appId)
  if (app) app.upvotes++
  document.querySelectorAll(`[data-id="${appId}"] .btn, [data-id="${appId}"] .win95-upvote-btn`).forEach(b => {
    b.classList.add('upvoted')
    const s = b.querySelector('span'); if (s && app) s.textContent = app.upvotes
  })
  updateStats()
  fetch(`${SUPABASE_URL}/rest/v1/votes`, {
    method: 'POST',
    headers: { 'apikey': SUPABASE_KEY, 'Authorization': `Bearer ${SUPABASE_KEY}`, 'Content-Type': 'application/json', 'Prefer': 'return=minimal' },
    body: JSON.stringify({ app_id: appId, user_fingerprint: 'u-'+Math.random().toString(36).substr(2,9), vote_type: 'upvote' })
  }).catch(() => {})
}

/* â”€â”€â”€ RATING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
async function handleRating(appId, rating, btn) {
  if (localStorage.getItem(`rated_${appId}`)) return
  const stars = btn.parentElement.querySelectorAll('.star-btn')
  stars.forEach((s, i) => {
    s.textContent = i < rating ? 'â˜…' : 'â˜†'
    s.classList.toggle('filled', i < rating)
    setTimeout(() => { s.style.transform = 'scale(1.3)'; setTimeout(() => s.style.transform = '', 180) }, i * 50)
  })
  localStorage.setItem(`rated_${appId}`, rating)
  const app = allApps.find(a => a.id === appId)
  if (app) { app.rating_sum += rating; app.rating_count++ }
  updateStats()
  fetch(`${SUPABASE_URL}/rest/v1/votes`, {
    method: 'POST',
    headers: { 'apikey': SUPABASE_KEY, 'Authorization': `Bearer ${SUPABASE_KEY}`, 'Content-Type': 'application/json', 'Prefer': 'return=minimal' },
    body: JSON.stringify({ app_id: appId, user_fingerprint: 'u-'+Math.random().toString(36).substr(2,9), vote_type: 'rating', rating_value: rating })
  }).catch(() => {})
}

/* â”€â”€â”€ RENDER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function renderApps() {
  const container = document.getElementById('app-container')
  let filtered = allApps

  if (currentSearch) {
    const q = currentSearch.toLowerCase()
    filtered = filtered.filter(a =>
      a.name?.toLowerCase().includes(q) ||
      a.description?.toLowerCase().includes(q) ||
      a.tags?.some(t => t.toLowerCase().includes(q))
    )
  }
  if (currentCategory !== 'all') {
    filtered = filtered.filter(a => a.category === currentCategory)
  }

  if (!filtered.length) {
    container.innerHTML = `<div class="empty-state"><div class="empty-icon">ğŸ”</div><p>No results for <strong>"${currentSearch || currentCategory}"</strong></p></div>`
    return
  }

  const cats = currentCategory === 'all'
    ? [...new Set(filtered.map(a => a.category || 'Other'))].sort()
    : [currentCategory]

  container.innerHTML = cats.map(cat => {
    const apps = filtered.filter(a => (a.category || 'Other') === cat)
    if (!apps.length) return ''
    return `
      <div class="category-section">
        <div class="category-header">
          <span class="category-label">${cat}</span>
          <div class="category-line"></div>
          <span class="category-count">${apps.length}</span>
        </div>
        <div class="app-grid">${apps.map((a, i) => createCard(a, i * 40)).join('')}</div>
      </div>`
  }).join('')

  requestAnimationFrame(observeCards)
}

/* â”€â”€â”€ STATS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function updateStats() {
  const upvotes = allApps.reduce((s, a) => s + (a.upvotes || 0), 0)
  const rated   = allApps.filter(a => a.rating_count > 0)
  const avg     = rated.length ? (rated.reduce((s, a) => s + a.rating_sum / a.rating_count, 0) / rated.length).toFixed(1) : 'â€”'
  document.getElementById('nav-count').textContent   = allApps.length
  document.getElementById('nav-upvotes').textContent = upvotes
  document.getElementById('nav-rating').textContent  = avg
}

/* â”€â”€â”€ LOAD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
async function loadApps() {
  const res = await fetch(`${SUPABASE_URL}/rest/v1/apps?order=featured.desc,upvotes.desc`, {
    headers: { 'apikey': SUPABASE_KEY, 'Authorization': `Bearer ${SUPABASE_KEY}` }
  })
  allApps = await res.json()

  const cats = [...new Set(allApps.map(a => a.category).filter(Boolean))].sort()
  document.getElementById('category-filter').innerHTML =
    '<option value="all">All Categories</option>' + cats.map(c => `<option value="${c}">${c}</option>`).join('')

  const skel = document.getElementById('skeleton')
  if (skel) skel.remove()

  renderApps()
  updateStats()
}

/* â”€â”€â”€ EVENTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
let searchTimer
document.getElementById('search-input').addEventListener('input', e => {
  clearTimeout(searchTimer)
  searchTimer = setTimeout(() => { currentSearch = e.target.value; renderApps() }, 250)
})
document.getElementById('category-filter').addEventListener('change', e => {
  currentCategory = e.target.value; renderApps()
})

loadApps()

/* â”€â”€â”€ ANIMATED BACKGROUND CANVAS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
(function() {
  const canvas = document.getElementById('bg-canvas')
  const ctx    = canvas.getContext('2d')

  // Aurora blobs config
  const DARK_BLOBS = [
    { x: 0.15, y: 0.12, r: 0.45, color: [124, 58, 237],  speed: 0.00018, phase: 0 },
    { x: 0.80, y: 0.75, r: 0.38, color: [56, 189, 248],  speed: 0.00013, phase: 2.1 },
    { x: 0.55, y: 0.40, r: 0.30, color: [167, 80, 220],  speed: 0.00022, phase: 4.3 },
    { x: 0.25, y: 0.80, r: 0.25, color: [30, 120, 220],  speed: 0.00016, phase: 1.5 },
  ]
  const LIGHT_BLOBS = [
    { x: 0.15, y: 0.12, r: 0.45, color: [167, 139, 250], speed: 0.00018, phase: 0 },
    { x: 0.80, y: 0.75, r: 0.38, color: [56, 189, 248],  speed: 0.00013, phase: 2.1 },
    { x: 0.55, y: 0.40, r: 0.30, color: [200, 150, 255], speed: 0.00022, phase: 4.3 },
    { x: 0.25, y: 0.80, r: 0.25, color: [100, 180, 255], speed: 0.00016, phase: 1.5 },
  ]

  // Floating particles
  const PARTICLE_COUNT = 55
  let particles = []

  function initParticles() {
    particles = Array.from({ length: PARTICLE_COUNT }, () => ({
      x: Math.random(),
      y: Math.random(),
      r: 0.8 + Math.random() * 1.8,
      vx: (Math.random() - 0.5) * 0.00012,
      vy: -0.00006 - Math.random() * 0.00010,
      alpha: 0.08 + Math.random() * 0.22,
      phase: Math.random() * Math.PI * 2,
      speed: 0.0004 + Math.random() * 0.0006,
    }))
  }
  initParticles()

  function resize() {
    canvas.width  = window.innerWidth
    canvas.height = window.innerHeight
  }
  window.addEventListener('resize', resize)
  resize()

  let t = 0
  let raf

  function draw(ts) {
    t = ts
    const W = canvas.width, H = canvas.height
    const isLight = document.documentElement.getAttribute('data-theme') === 'light'
    const isWin95 = document.documentElement.getAttribute('data-theme') === 'win95'

    ctx.clearRect(0, 0, W, H)

    if (isWin95) {
      // Win95: solid teal â€” nothing to draw
      raf = requestAnimationFrame(draw)
      return
    }

    // â”€â”€ Base gradient â”€â”€
    const base = ctx.createRadialGradient(W * 0.5, H * 0.5, 0, W * 0.5, H * 0.5, Math.max(W, H) * 0.8)
    if (isLight) {
      base.addColorStop(0, '#f0eeff')
      base.addColorStop(0.5, '#e8f4ff')
      base.addColorStop(1, '#f5f0ff')
    } else {
      base.addColorStop(0, '#0f0c29')
      base.addColorStop(0.5, '#1a1040')
      base.addColorStop(1, '#24243e')
    }
    ctx.fillStyle = base
    ctx.fillRect(0, 0, W, H)

    // â”€â”€ Aurora blobs â”€â”€
    const blobs = isLight ? LIGHT_BLOBS : DARK_BLOBS
    blobs.forEach(b => {
      const wobX = Math.sin(t * b.speed + b.phase) * 0.08
      const wobY = Math.cos(t * b.speed * 0.7 + b.phase) * 0.06
      const cx   = (b.x + wobX) * W
      const cy   = (b.y + wobY) * H
      const rad  = b.r * Math.max(W, H)
      const grd  = ctx.createRadialGradient(cx, cy, 0, cx, cy, rad)
      const alpha = isLight ? 0.10 : 0.20
      grd.addColorStop(0, `rgba(${b.color[0]},${b.color[1]},${b.color[2]},${alpha})`)
      grd.addColorStop(1, `rgba(${b.color[0]},${b.color[1]},${b.color[2]},0)`)
      ctx.fillStyle = grd
      ctx.fillRect(0, 0, W, H)
    })

    // â”€â”€ Floating particles â”€â”€
    particles.forEach(p => {
      p.x += p.vx + Math.sin(t * p.speed + p.phase) * 0.00005
      p.y += p.vy
      if (p.y < -0.02) { p.y = 1.02; p.x = Math.random() }
      if (p.x < -0.02) p.x = 1.02
      if (p.x >  1.02) p.x = -0.02

      const pulse = 0.5 + 0.5 * Math.sin(t * p.speed * 2 + p.phase)
      const a = p.alpha * (0.6 + 0.4 * pulse)
      ctx.beginPath()
      ctx.arc(p.x * W, p.y * H, p.r, 0, Math.PI * 2)
      ctx.fillStyle = isLight
        ? `rgba(120,80,220,${a})`
        : `rgba(180,140,255,${a})`
      ctx.fill()
    })

    raf = requestAnimationFrame(draw)
  }

  raf = requestAnimationFrame(draw)
})()
</script>
</body>
</html>
